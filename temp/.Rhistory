mediation
help mediation
library(lme4)
library(ggplot2)
library(mediation)
library(lmerTest)
library(lme4)
library(ggplot2)
library(mediation)
library(lmerTest)
setwd("../temp/")
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df$age06mc <- df$age06 - mean(df$age06)
df$agesq <- df$age06mc^2
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$gmvnohv <- (df$gmv - df$hv)/100
age.mem.plot <- ggplot(df, aes(x=age, y=memory, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=22)
plot(age.mem.plot)
wmh.mem.plot <- ggplot(df, aes(x=log(wmh), y=memory, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6)+
theme_bw(base_size=22)
plot(wmh.mem.plot)
spaghettiPlot <- function(x, y, group, xLab, yLab) {
ggplot(df, aes(x, y, group=group)) +
geom_line() + geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=22) +
labs(x=xLab, y=yLab)
}
scatterPlot <- function(x, y, m, xLab, yLab, mLab) {
ggplot(df, aes(x, y)) + geom_point(aes(color=m), size=2) +
scale_color_gradient(low="cyan", high="blue") +
labs(x=xLab, y=yLab, colour=mLab) +
theme_classic()
}
df <- read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df$subject <- factor(df$rundmcs)
df$logwmh <- log(df$wmh)
df$age06 <- (df$age06) #scale
df$agesq <- df$age06^2
df$timesq <- df$time^2
df$times <- as.factor(df$times)
scatterPlot(df$logwmh, df$memory, df$age,
"White matter hyperintensities", "Memory", "Age")
scatterPlot(df$hv, df$memory, df$age,
"Hippocampal volumes", "Memory", "Age")
scatterPlot(df$logwmh, df$memory, df$age,
"WMH volume (log ml)", "Memory (z-score)", "Age (years)")
scatterPlot(df$hv, df$memory, df$age,
"Hippocampal volume (ml)", "Memory (z-score)", "Age (years)")
library(lme4)
library(ggplot2)
library(mediation)
library(lmerTest)
setwd("../temp/")
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df$age06mc <- df$age06 - mean(df$age06)
df$agesq <- df$age06mc^2
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$gmvnohv <- (df$gmv - df$hv)/100
m0 = lmer(memory ~  df$age06mc + sex + educationyears + time + timesqrt + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(m0)
knitr::opts_chunk$set(echo = F,
message = F,
warning = F,
results='asis')
library(stargazer)
library(lme4)
library(tidyverse)
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
# apply data transformations
df$age06s <- scale(df$age06)
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$timesq <- df$time^2
df$lnwmh <- log(df$wmh)
altIndex <- c("psychomotorspeed", "fluency", "responseinhibition", "attention",
"executivefunction")
df$cognitiveindex_nomem <- rowMeans(df[altIndex], na.rm=T)
df$gmvnohv <- df$gmv - df$hv
df <- df[complete.cases(df[, c("lnwmh", "hv")]),]
model1 <- lme4::lmer(memory ~ age06 + time + timesq +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(model1, header=F,  ci=T, ci.level = .95)
model2 <- lme4::lmer(memory ~ age06 + time + timesq*lnwmh +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model3 <- lme4::lmer(memory ~ age06 + sex + time*hv + timesq  +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model4 <- lme4::lmer(memory ~ age06 + time*hv + timesq*lnwmh +
hv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model1, model2, model3, model4), summary = F)
stargazer(model1, model2, model3, model4,
title = "Fixed effects results",
ci=T, ci.level = .95,
omit="Constant", dep.var.labels = "Memory",
order=c(1,2,4,5,8,3,10,9,6,7),
covariate.labels = c("Baseline age (years)", "Time to follow-up (linear)",
"Time to follow-up (quadratic)", "WMH", "WMH * Time (quadratic)",
"HV", "HV * Time (linear)", "WMH * HV", "Sex", "Education (years)"),
star.cutoffs = c(0.05, 0.01, 0.001),
column.labels = c("Null", "WMH only", "HV only", "Full"),
initial.zero = F,
header=F)
model4a <- mixed(memory ~ age06 + time*gmvnohv + timesq*lnwmh +
gmvnohv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model4a <- lme4::lmer(memory ~ age06 + time*gmvnohv + timesq*lnwmh +
gmvnohv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model4b <- lme4::lmer(cognitiveindex_nomem ~ age06 + time*gmvnohv + timesq*lnwmh +
gmvnohv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model4, model4a, model4b), summary=F, header=F)
library(afex)
install.packages("afex")
model4a <- lme4::lmer(memory ~ age06 + time*gmvnohv + timesq*lnwmh +
gmvnohv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model4b <- lme4::lmer(cognitiveindex_nomem ~ age06 + time*gmvnohv + timesq*lnwmh +
gmvnohv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model4, model4a, model4b), summary=F, header=F)
library(afex)
library(mediation)
modelmed <- lme4::lmer(hv ~ age06 + time + timesq*lnwmh +
sex + educationyears + (1|rundmcs),
data=df, REML=F)
modelout <- lme4::lmer(memory ~ age06 + time + timesq*lnwmh +
lnwmh*hv + sex + educationyears +
(1 + time|rundmcs), data=df, REML=F)
mediate(modelmed, modelout, treat="memory", mediator="hv")
model4a <- lme4::lmer(memory ~ age06 + time*gmvnohv + timesq*lnwmh +
gmvnohv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model4b <- lme4::lmer(cognitiveindex_nomem ~ age06 + time*gmvnohv + timesq*lnwmh +
gmvnohv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model4, model4a, model4b), summary=F, header=F)
model3a <- lme4::lmer(memory ~ age06 + sex + time*gmvnohv + timesq  +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model4a <- lme4::lmer(memory ~ age06 + time*gmvnohv + timesq*lnwmh +
gmvnohv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model1, model2, model3a, model4a), summary = F)
stargazer(model1, model2, model3a, model4a,
title = "Fixed effects results",
ci=T, ci.level = .95,
omit="Constant", dep.var.labels = "Memory",
order=c(1,2,4,5,8,3,10,9,6,7),
covariate.labels = c("Baseline age (years)", "Time to follow-up (linear)",
"Time to follow-up (quadratic)", "WMH", "WMH * Time (quadratic)",
"GMV", "GMV * Time (linear)", "WMH * GMV", "Sex", "Education (years)"),
star.cutoffs = c(0.05, 0.01, 0.001),
column.labels = c("Null", "WMH only", "GMV only", "Full"),
initial.zero = F,
header=F)
install.packages("rmarkdown")
install.packages("rmarkdown")
library(rmarkdown)
library(stargazer)
library(lme4)
library(tidyverse)
model1 <- lme4::lmer(memory ~ age06 + time + timesq +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(model1, header=F,  ci=T, ci.level = .95)
install.packages("pdflatex")
install.packages("TeX")
m0.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + df$gmvnohv*time
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
m1.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + df$gmvnohv*time + log(wmh)*df$gmvnohv
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(m0.wmh.gmv.mem.adj1)
summary(m1.wmh.gmv.mem.adj1)
anova(m1.wmh.gmv.mem.adj1, m0.wmh.gmv.mem.adj1)
m0.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + df$gmvnohv*time
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
df$age06mc <- df$age06 - mean(df$age06)
df$agesq <- df$age06mc^2
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$gmvnohv <- (df$gmv - df$hv)/100
m0.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + df$gmvnohv*time
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
m1.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + df$gmvnohv*time + log(wmh)*df$gmvnohv
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(m0.wmh.gmv.mem.adj1)
summary(m1.wmh.gmv.mem.adj1)
anova(m1.wmh.gmv.mem.adj1, m0.wmh.gmv.mem.adj1)
m0.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + df$gmvnohv*time
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
m1.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + df$gmvnohv*time + log(wmh)*df$gmvnohv
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(m0.wmh.gmv.mem.adj1)
summary(m1.wmh.gmv.mem.adj1)
anova(m1.wmh.gmv.mem.adj1, m0.wmh.gmv.mem.adj1)
knitr::opts_chunk$set(echo = F,
message = F,
warning = F,
results='asis')
library(stargazer)
library(lme4)
library(tidyverse)
library(ggplot2)
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
# apply data transformations
df$age06s <- scale(df$age06)
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$timesq <- df$time^2
df$lnwmh <- log(df$wmh)
altIndex <- c("psychomotorspeed", "fluency", "responseinhibition", "attention",
"executivefunction")
df$cognitiveindex_nomem <- rowMeans(df[altIndex], na.rm=T)
df$gmvnohv <- df$gmv - df$hv
df <- df[complete.cases(df[, c("lnwmh", "hv")]),]
scatterPlot <- function(x, y, m, xLab, yLab, mLab) {
ggplot(df, aes(x, y)) + geom_point(aes(color=m), size=2) +
scale_color_gradient(low="cyan", high="blue") +
labs(x=xLab, y=yLab, colour=mLab) +
theme_classic()
}
scatterPlot.wmh <- ggplot(df, aes(lnwmh, memory)) + geom_point(aes(color=age06), size=2) +
scale_color_gradient(low="cyan", high="blue") +
labs(x="WMH volume (log ml)", y="Memory (z-score)", colour="Age (years)") +
theme_classic()
View(df)
