setwd("~/Documenten_Esther/OiO/Cambridge/RUNDMC_LGM/cognitive_decline_LME/scripts")
library(lme4)
library(ggplot2)
library(mediation)
setwd("../temp/")
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df$age06mc <- df$age06 - mean(df$age06)
df$agesq <- df$age06mc^2
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$gmvnohv <- (df$gmv - df$hv)/100
variables.mem <- c("wmh", "hv", "memory")
df.incl.mem <- df[complete.cases(df[variables.mem]),]
model.m2 <- lmer(hv ~ log(wmh) + time + timesqrt
+ age06mc + sex + (1+time|rundmcs),
model.m2 <- lmer(hv ~ log(wmh) + time + timesqrt
# Memory
variables.mem <- c("wmh", "hv", "memory")
df.incl.mem <- df[complete.cases(df[variables.mem]),]
model.m2 <- lmer(hv ~ log(wmh) + time + timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y2 <- lmer(memory ~ log(wmh) + hv + time + timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate2.out <- mediate(model.m2, model.y2, treat = "log(wmh)", mediator = "hv")
summary(model.m2)
summary(model.y2)
summary(mediate2.out)
df.wide = read.csv("../data/RUNDMC_data_wide.csv", sep=";", dec=",")
model.ha <- lmer(hv ~  time + age06mc + sex + log(wmh) + (1+time|rundmcs),
model.ha <- lmer(hv ~  time + age06mc + sex + log(wmh) + (1+time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(model.ha)
coef(summary(model.ha))[ , "Estimate"]
ha.slopes <- coef(model.ha)$rundmcs
ha <- ha.slopes$time
df.wide$ha <- ha
variables.mem <- c("wmh06", "ha", "memory0615")
df.wide.incl.mem <- df.wide[complete.cases(df.wide[variables.mem]),]
model.m10 <- lm(ha ~ log(wmh06) + Age_2006 + Sex,
data=df.wide.incl.mem, na.action=na.exclude)
model.y10 <- lm(memory0615 ~ log(wmh06) + ha + Age_2006 + Sex,
data=df.wide.incl.mem, na.action=na.exclude)
mediate10.out <- mediate(model.m10, model.y10, treat = "log(wmh06)", mediator = "ha")
summary(model.m10)
summary(model.y10)
summary(mediate10.out)
lmer(memory06~ha+Age_2006+Sex,data=df.wide.incl.mem)
glm(memory06~ha+Age_2006+Sex,data=df.wide.incl.mem)
m1 <- glm(memory0615~ha+Age_2006+Sex,data=df.wide.incl.mem)
summary(m1)
m1 <- glm(memory0615~ha+hv+Age_2006+Sex,data=df.wide.incl.mem)
summary(m1)
m1 <- glm(memory0615~ha+hv06+Age_2006+Sex,data=df.wide.incl.mem)
summary(m1)
library(lavaan)
model <- '
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06
ha~a1*wmh06
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
sem(model,data=df.wide.incl.mem)
m2 <- sem(model,data=df.wide.incl.mem)
summary(m2)
model <- '
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06
ha~a1*wmh06
hv06 ~~ ha
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m2 <- sem(model,data=df.wide.incl.mem)
summary(m2)
model <- '
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06 + memory06
ha~a1*wmh06
hv06 ~~ ha
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m2 <- sem(model,data=df.wide.incl.mem)
summary(m2)
