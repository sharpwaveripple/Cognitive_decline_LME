mediation
help mediation
library(lme4)
library(ggplot2)
library(mediation)
library(lavaan)
library(lme4)
library(ggplot2)
library(mediation)
library(lavaan)
setwd("../temp/")
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df.wide = read.csv("../data/RUNDMC_data_wide.csv", sep=";", dec=",")
df$age06mc <- df$age06 - mean(df$age06)
df$agesq <- df$age06mc^2
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$gmvnohv <- (df$gmv - df$hv)/100
# Mediation analyses WMH -> Hippo -> Memory
# Memory
variables.mem <- c("wmh", "hv", "memory")
df.incl.mem <- df[complete.cases(df[variables.mem]),]
model.m1 <- lmer(hv ~ log(wmh) + time + timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y1 <- lmer(memory ~ log(wmh) + hv + time + timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate1.out <- mediate(model.m1, model.y1, treat = "log(wmh)", mediator = "hv")
summary(model.m1)
summary(model.y1)
summary(mediate1.out)
# Define individual hippocampal atrophy slopes (ha)
model.ha <- lmer(hv ~  time + age06mc + sex + log(wmh) + (1+time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(model.ha)
coef(summary(model.ha))[ , "Estimate"]
ha.slopes <- coef(model.ha)$rundmcs
ha <- ha.slopes$time
df.wide$ha <- ha
# Mediation analysis on cross-sectional data
# Memory - wmh -> ha -> memory
variables.mem <- c("wmh06", "ha", "memory0615")
df.wide.incl.mem <- df.wide[complete.cases(df.wide[variables.mem]),]
model.m2 <- lm(ha ~ log(wmh06) + Age_2006 + Sex,
data=df.wide.incl.mem, na.action=na.exclude)
model.y2 <- lm(memory0615 ~ log(wmh06) + ha + Age_2006 + Sex,
data=df.wide.incl.mem, na.action=na.exclude)
mediate2.out <- mediate(model.m2, model.y2, treat = "log(wmh06)", mediator = "ha")
summary(model.m2)
summary(model.y2)
summary(mediate2.out)
# Mediation using Lavaan
m3 <- glm(memory0615 ~ ha + hv06 + Age_2006 + Sex, data=df.wide.incl.mem)
summary(m3)
model <- '
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06 + memory06
ha~a1*wmh06
hv06 ~~ ha
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m4 <- sem(model,data=df.wide.incl.mem)
summary(m4)
model <- '
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06 + memory06
ha ~ a1*wmh06
hv06 ~~ ha
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m4 <- sem(model,data=df.wide.incl.mem)
model <- '
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06 + memory06
ha ~ a1*wmh06
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m4 <- sem(model,data=df.wide.incl.mem)
summary(m4)
model <- '
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06 + memory06
ha ~ a1*wmh06
ha ~~ hv06
memory0615 ~~ memory06
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m4 <- sem(model,data=df.wide.incl.mem)
model <- '
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06 + memory06
ha ~ a1*wmh06
ha ~~ hv06
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m4 <- sem(model,data=df.wide.incl.mem)
m4 <- sem(model,data=df.wide.incl.mem, fixed.x=FALSE)
summary(m4)
model <- '
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06 + memory06
ha ~ a1*wmh06
ha ~~ hv06
direct.wmh := c1
direct.ha := b1
direct.wmh.ha := a1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m4 <- sem(model,data=df.wide.incl.mem, fixed.x=FALSE)
summary(m4)
model <- '
# Regression models
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06 + memory06
ha ~ a1*wmh06
# Covariances
ha ~~ hv06
# Defined parameters
mem.wmh := c1
mem.ha := b1
ha.wmh := a1
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m4 <- sem(model,data=df.wide.incl.mem, fixed.x=FALSE)
summary(m4)
model <- '
# Regression models
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06 + memory06
ha ~ a1*wmh06
# Covariances
# ha ~~ hv06
# Defined parameters
mem.wmh := c1
mem.ha := b1
ha.wmh := a1
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m4 <- sem(model,data=df.wide.incl.mem, fixed.x=FALSE)
summary(m4)
model <- '
# Regression models
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + c1*wmh06 + memory06
ha ~ a1*wmh06
# Covariances
ha ~~ hv06
# Defined parameters
mem.wmh := c1
mem.ha := b1
ha.wmh := a1
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
m4 <- sem(model,data=df.wide.incl.mem, fixed.x=FALSE)
summary(m4)
# Define individual hippocampal atrophy slopes (ha)
model.ha <- lmer(hv ~  time + age06mc + sex + log(wmh) + (1+time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(model.ha)
coef(summary(model.ha))[ , "Estimate"]
ha.slopes <- coef(model.ha)$rundmcs
head(ha.slopes)
mediation.model <- sem(model,data=df.wide.incl.mem, fixed.x=FALSE)
summary(mediation.model)
