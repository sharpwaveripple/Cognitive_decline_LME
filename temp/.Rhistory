library(lme4)
library(ggplot2)
library(mediation)
library(lavaan)
library(lme4)
library(ggplot2)
library(mediation)
library(lavaan)
setwd("../temp/")
setwd("G:/Documenten_Esther/OiO/Cambridge/RUNDMC_LGM/cognitive_decline_LME/scripts")
setwd("../temp/")
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df.wide = read.csv("../data/RUNDMC_data_wide.csv", sep=";", dec=",")
df$age06mc <- df$age06 - mean(df$age06)
df$agesq <- df$age06mc^2
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$gmvnohv <- (df$gmv - df$hv)/100
# Define individual hippocampal atrophy slopes (ha)
model.ha <- lmer(hv ~  time + age06mc + sex + log(wmh) + (1+time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(model.ha)
coef(summary(model.ha))[ , "Estimate"]
ha.slopes <- coef(model.ha)$rundmcs
ha <- ha.slopes$time
df.wide$ha <- ha
# Mediation analysis on cross-sectional dataset using Lavaan
# Memory - wmh -> ha -> memory
variables.mem <- c("wmh06", "ha", "memory0615")
df.wide.incl.mem <- df.wide[complete.cases(df.wide[variables.mem]),]
model <- '
# Regression models
memory0615 ~ hv06 + b1*ha + Age_2006 + Sex + educationyears + c1*wmh06 + memory06
ha ~ a1*wmh06
# Covariances
ha ~~ hv06
# Defined parameters
mem.wmh := c1
mem.ha := b1
ha.wmh := a1
direct := c1
indirect := b1*a1
totaal := c1 + (b1*a1)'
mediation.model <- sem(model, data=df.wide.incl.mem, fixed.x=FALSE)
summary(mediation.model)
library(stargazer)
install.packages("stargazer")
install.packages("tidyverse")
install.packages("tidyverse")
library(stargazer)
library(lme4)
library(mice)
library(tidyverse)
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df$age06s <- scale(df$age06)
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$timesq <- df$time^2
df$lnwmh <- log(df$wmh)
df$gmvnohv <- df$gmv - df$hv
df <- df[complete.cases(df[, c("lnwmh", "hv")]),]
model1 <- lme4::lmer(memory ~ age06 + time + timesq + sex + educationyears + (1 + time|rundmcs),
data=df, REML=F)
stargazer(model1, header=F,  ci=T, ci.level = .95)
model2 <- lme4::lmer(memory ~ age06 + time + sex + timesq*lnwmh  + educationyears + (1 + time|rundmcs),
data=df, REML=F)
model3 <- lme4::lmer(memory ~ age06 + sex + time*hv + timesq  + educationyears + (1 + time|rundmcs),
data=df, REML=F)
model4 <- lme4::lmer(memory ~ age06 + sex + time*hv + timesq*lnwmh + hv*lnwmh  + educationyears + (1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model1, model2, model3, model4), summary = F)
stargazer(model1, model2, model3, model4,
title = "Fixed effect results",
ci=T, ci.level = .95,
omit="Constant",
star.cutoffs = c(0.05, 0.01, 0.001),
header=F)
model5 <- lme4::lmer(memory ~ age06 + sex + educationyears + time*hv + timesq*lnwmh + (1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model1, model2, model3, model5, model4), summary = F)
stargazer(model1, model2, model3, model5, model4,
title = "Fixed effect results",
ci=T, ci.level = .95,
omit="Constant",
star.cutoffs = c(0.05, 0.01, 0.001),
header=F)
anova(model4, model5)
model1 <- lme4::lmer(memory ~ age06 + time + timesq + sex + educationyears + (1 + time|rundmcs),
data=df, REML=F)
stargazer(model1, header=F,  ci=T, ci.level = .95)
knitr::opts_chunk$set(echo = F,
message = F,
warning = F,
results='asis')
library(stargazer)
library(lme4)
library(mice)
library(tidyverse)
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
#variables <- c("rundmcs", "sex", "age06", "time", "gmv", "wmh",
#               "hv", "verbalmemory", "visuospatialmemory",
#              "immediatememory", "delayedmemory", "workingmemory")
#df <- df[variables]
# apply data transformations
df$age06s <- scale(df$age06)
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$timesq <- df$time^2
df$lnwmh <- log(df$wmh)
df$gmvnohv <- df$gmv - df$hv
df <- df[complete.cases(df[, c("lnwmh", "hv")]),]
model1 <- lme4::lmer(memory ~ age06 + sex + educationyears + time + timesq + (1 + time|rundmcs),
data=df, REML=F)
stargazer(model1, header=F,  ci=T, ci.level = .95)
model2 <- lme4::lmer(memory ~ age06 + sex + educationyears + time + timesq*lnwmh + (1 + time|rundmcs),
data=df, REML=F)
model3 <- lme4::lmer(memory ~ age06 + sex + educationyears + time*hv + timesq + (1 + time|rundmcs),
data=df, REML=F)
model5 <- lme4::lmer(memory ~ age06 + sex + educationyears + time*hv + timesq*lnwmh + (1 + time|rundmcs),
data=df, REML=F)
model4 <- lme4::lmer(memory ~ age06 + sex + educationyears + time*hv + timesq*lnwmh + hv*lnwmh  + (1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model1, model2, model3, model5, model4), summary = F)
stargazer(model1, model2, model3, model5, model4,
title = "Fixed effect results",
ci=T, ci.level = .95,
omit="Constant",
star.cutoffs = c(0.05, 0.01, 0.001),
header=F)
library(rmarkdown)
library(rmarkdown)
render("Test_EvL_lme_memory.Rmd", output_format = "word_document")
knitr::opts_chunk$set(echo = F,
message = F,
warning = F,
results='asis')
library(stargazer)
library(lme4)
library(tidyverse)
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
# apply data transformations
df$age06s <- scale(df$age06)
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$timesq <- df$time^2
df$lnwmh <- log(df$wmh)
altIndex <- c("psychomotorspeed", "fluency", "responseinhibition", "attention",
"executivefunction")
df$cognitiveindex_nomem <- rowMeans(df[altIndex], na.rm=T)
df$gmvnohv <- df$gmv - df$hv
df <- df[complete.cases(df[, c("lnwmh", "hv")]),]
model1 <- lme4::lmer(memory ~ age06 + time + timesq +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(model1, header=F,  ci=T, ci.level = .95)
model1 <- lme4::lmer(memory ~ age06 + sex + educationyears +
time + timesq +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(model1, header=F,  ci=T, ci.level = .95)
model2 <- lme4::lmer(memory ~ age06 + time + timesq*lnwmh +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model3 <- lme4::lmer(memory ~ age06 + sex + time*hv + timesq  +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model4 <- lme4::lmer(memory ~ age06 + time*hv + timesq*lnwmh +
hv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model5 <- lme4::lmer(memory ~ age06 + time*hv + timesq*lnwmh +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model1, model2, model3, model5, model4), summary = F)
stargazer(model1, model2, model3, model5, model4,
title = "Fixed effects results",
ci=T, ci.level = .95,
omit="Constant", dep.var.labels = "Memory",
order=c(1,2,4,5,8,3,10,9,6,7),
covariate.labels = c("Age (years)", "Time to follow-up (linear)",
"Time to follow-up (quadratic)", "WMH", "WMH progression",
"HV", "Hippocampal atrophy", "WMH * HV interaction", "Sex", "Education (years)"),
star.cutoffs = c(0.05, 0.01, 0.001),
column.labels = c("Null", "WMH only", "HV only", "WMH & HV", "Full"),
initial.zero = F,
header=F)
model2 <- lme4::lmer(memory ~ age06 + time + timesq*lnwmh +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model3 <- lme4::lmer(memory ~ age06 + sex + time*hv + timesq  +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model4 <- lme4::lmer(memory ~ age06 + time*hv + timesq*lnwmh +
hv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model5 <- lme4::lmer(memory ~ age06 + time*hv + timesq*lnwmh +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model1, model2, model3, model5, model4), summary = F)
stargazer(model1, model2, model3, model5, model4,
title = "Fixed effects results",
ci=T, ci.level = .95,
omit="Constant", dep.var.labels = "Memory",
order=c(1,6,7,2,4,5,8,3,10,9),
covariate.labels = c("Age (years)", "Time to follow-up (linear)",
"Time to follow-up (quadratic)", "WMH", "WMH progression",
"HV", "Hippocampal atrophy", "WMH * HV interaction", "Sex", "Education (years)"),
star.cutoffs = c(0.05, 0.01, 0.001),
column.labels = c("Null", "WMH only", "HV only", "WMH & HV", "Full"),
initial.zero = F,
header=F)
model2 <- lme4::lmer(memory ~ age06 + time + timesq*lnwmh +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model3 <- lme4::lmer(memory ~ age06 + sex + time*hv + timesq  +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model4 <- lme4::lmer(memory ~ age06 + time*hv + timesq*lnwmh +
hv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model5 <- lme4::lmer(memory ~ age06 + time*hv + timesq*lnwmh +
sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model1, model2, model3, model5, model4), summary = F)
stargazer(model1, model2, model3, model5, model4,
title = "Fixed effects results",
ci=T, ci.level = .95,
omit="Constant", dep.var.labels = "Memory",
order=c(1,2,4,5,8,3,10,9,6,7),
covariate.labels = c("Age (years)", "Time to follow-up (linear)",
"Time to follow-up (quadratic)", "WMH", "WMH progression",
"HV", "Hippocampal atrophy", "WMH * HV interaction", "Sex", "Education (years)"),
star.cutoffs = c(0.05, 0.01, 0.001),
column.labels = c("Null", "WMH only", "HV only", "WMH & HV", "Full"),
initial.zero = F,
header=F)
model4a <- lme4::lmer(memory ~ age06 + time*gmvnohv + timesq*lnwmh +
gmvnohv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
model4b <- lme4::lmer(cognitiveindex_nomem ~ age06 + time*gmvnohv + timesq*lnwmh +
gmvnohv*lnwmh  + sex + educationyears +
(1 + time|rundmcs),
data=df, REML=F)
stargazer(anova(model4, model4a, model4b), summary=F, header=F)
age.mem.plot <- ggplot(df, aes(x=age, y=memory, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=22)
plot(age.mem.plot)
wmh.mem.plot <- ggplot(df, aes(x=log(wmh), y=memory, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6)+
theme_bw(base_size=22)
plot(wmh.mem.plot)
spaghettiPlot <- function(x, y, group, xLab, yLab) {
ggplot(df, aes(x, y, group=group)) +
geom_line() + geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=22) +
labs(x=xLab, y=yLab)
}
scatterPlot <- function(x, y, m, xLab, yLab, mLab) {
ggplot(df, aes(x, y)) + geom_point(aes(color=m), size=2) +
scale_color_gradient(low="cyan", high="blue") +
labs(x=xLab, y=yLab, colour=mLab) +
theme_classic()
}
df <- read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df$subject <- factor(df$rundmcs)
df$logwmh <- log(df$wmh)
df$age06 <- (df$age06) #scale
df$agesq <- df$age06^2
df$timesq <- df$time^2
df$times <- as.factor(df$times)
df2 <- read.csv("../data/RUNDMC_data_wide.csv", sep=";", dec=",")
spaghettiPlot(df$age, df$cognitiveindex, df$subject,
"Age", "Cognitive index")
spaghettiPlot(df$logwmh, df$cognitiveindex, df$subject,
"White matter hyperintensities", "Cognitive index")
spaghettiPlot(df$hv, df$cognitiveindex, df$rundmcs,
"Hippocampal volume", "Cognitive index")
scatterPlot(df$logwmh, df$cognitiveindex, df$age,
"White matter hyperintensities", "Cognitive index", "Age")
scatterPlot(df$logwmh, df$cognitiveindex, df$age,
"White matter hyperintensities", "Cognitive index", "Age")
scatterPlot(df$hv, df$cognitiveindex, df$age,
"Hippocampal volumes", "Cognitive index", "Age")
# here, each line segment represents a subject.
ggplot(df, aes(age, cognitiveindex, group=subject)) +
geom_point() + geom_line() +
geom_smooth(aes(group=1), method="lm", colour="red") +
geom_smooth(aes(group=1), method="lm", formula = y~poly(x, 2), colour="orange") +
scale_x_continuous(limits=c(50, 90), expand=c(0,0)) +
theme_classic()
# fixed effect of baseline age represents
with(x, ggplot(aes(age, cognitiveindex, group=subject)) + geom_point)
ggplot(df2, aes(Age_2006, cognitiveindex06)) + geom_point() + geom_smooth(method="lm")
ggplot(df, aes(age, cognitiveindex)) + geom_point()
x <- mice(df)
scatterPlot(df$logwmh, df$cognitiveindex, df$age,
"White matter hyperintensities", "Cognitive index", "Age")
scatterPlot(df$logwmh, df$memory, df$age,
"White matter hyperintensities", "Memory", "Age")
scatterPlot(df$hv, df$memory, df$age,
"Hippocampal volumes", "Memory", "Age")
anova(model5,model4)
anova(model2,model1)
anova(model3,model1)
