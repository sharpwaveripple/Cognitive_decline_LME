setwd("G:/Documenten_Esther/OiO/Cambridge/RUNDMC_LGM/cognitive_decline_LME/scripts")
library(lme4)
library(ggplot2)
library(mediation)
library(lmerTest)
library(lme4)
library(ggplot2)
library(mediation)
library(lmerTest)
setwd("../temp/")
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df$age06mc <- df$age06 - mean(df$age06)
df$agesq <- df$age06mc^2
df$tbv06mc <- df$tbv06 - mean(df$tbv06)
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$gmvnohv <- df$gmv - df$hv
age.mem.plot <- ggplot(df, aes(x=age, y=memory, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=22)
plot(age.mem.plot)
wmh.mem.plot <- ggplot(df, aes(x=log(wmh), y=memory, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6)+
theme_bw(base_size=22)
plot(wmh.mem.plot)
hv.mem.plot <- ggplot(df, aes(x=hv, y=memory, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6)+
theme_bw(base_size=22)
plot(hv.mem.plot)
m0.wmh.mem = lmer(memory ~ log(wmh) + time + timesqrt + df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
m1.wmh.mem = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(m0.wmh.mem)
summary(m1.wmh.mem)
anova(m1.wmh.mem, m0.wmh.mem)
m0.hv.mem = lmer(memory ~  hv + time + timesqrt + df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
m1.hv.mem = lmer(memory ~  hv*time + timesqrt + df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(m0.hv.mem)
summary(m1.hv.mem)
anova(m1.hv.mem, m0.hv.mem)
m0.wmh.hv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + hv*time
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
m1.wmh.hv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + hv*time + log(wmh)*hv
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
anova(m1.wmh.hv.mem.adj1, m0.wmh.hv.mem.adj1)
summary(m1.wmh.hv.mem.adj1)
m0.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + gmv2*time
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
m0.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + gmv*time
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
m1.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + gmv*time + log(wmh)*gmv
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(m1.wmh.gmv.mem.adj1)
df$gmvnohv
df$gmvnohv <- (df$gmv - df$hv)/100
m0.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + df$gmvnohv*time
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
m1.wmh.gmv.mem.adj1 = lmer(memory ~ log(wmh)*time + log(wmh)*timesqrt + df$gmvnohv*time + log(wmh)*df$gmvnohv
+ df$age06mc + sex + (1 + time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(m0.wmh.gmv.mem.adj1)
summary(m1.wmh.gmv.mem.adj1)
anova(m1.wmh.gmv.mem.adj1, m0.wmh.gmv.mem.adj1)
library(lme4)
library(ggplot2)
library(mediation)
library(lmerTest)
setwd("../temp/")
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df$age06mc <- df$age06 - mean(df$age06)
df$agesq <- df$age06mc^2
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$gmvnohv <- (df$gmv - df$hv)/100
# Memory
variables.mem <- c("wmh", "hv", "memory")
df.incl.mem <- df[complete.cases(df[variables.mem]),]
model.m2 <- lmer(hv ~ log(wmh) + time + timesqrt + age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y2 <- lmer(memory ~ log(wmh) + hv + time + timesqrt + age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate2.out <- mediate(model.m2, model.y2, treat = "log(wmh)", mediator = "hv")
mediate2.out <- mediate(model.m2, model.y2, treat = "log(wmh)", mediator = "hv")
library(mediation)
mediate2.out <- mediate(model.m2, model.y2, treat = "log(wmh)", mediator = "hv")
detach("package:lmerTest", unload=TRUE)
library(lme4)
library(ggplot2)
library(mediation)
setwd("../temp/")
df = read.csv("../data/RUNDMC_data_long.csv", sep=";", dec=",")
df$age06mc <- df$age06 - mean(df$age06)
df$agesq <- df$age06mc^2
df$sex <- factor(df$sex)
df$rundmcs <- factor(df$rundmcs)
df$gmvnohv <- (df$gmv - df$hv)/100
# Memory
variables.mem <- c("wmh", "hv", "memory")
df.incl.mem <- df[complete.cases(df[variables.mem]),]
model.m2 <- lmer(hv ~ log(wmh) + time + timesqrt + age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y2 <- lmer(memory ~ log(wmh) + hv + time + timesqrt + age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate2.out <- mediate(model.m2, model.y2, treat = "log(wmh)", mediator = "hv")
summary(mediate2.out)
summary(model.y2)
model.m3 <- lmer(hv ~ log(wmh) + time + timesqrt
+ df$age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.m3 <- lmer(hv ~ log(wmh) + time + timesqrt
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.m3 <- lmer(hv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y3 <- lmer(memory ~ log(wmh) + hv + time + timesqrt + log(wmh):time + log(wmh):timesqrt + hv:time
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate3.out <- mediate(model.m3, model.y3, treat = "log(wmh)", mediator = "hv")
summary(mediate3.out)
summary(model.y3)
# Specificity - WMH - GMV - Memory
variables.mem2 <- c("wmh", "gmv", "memory")
df.incl.mem2 <- df[complete.cases(df[variables.mem2]),]
model.m4 <- lmer(gmv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem2, REML=FALSE, na.action=na.exclude)
model.y4 <- lmer(memory ~ log(wmh) + gmv + time + timesqrt + log(wmh):time + log(wmh):timesqrt + gmv:time
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem2, REML=FALSE, na.action=na.exclude)
model.m4 <- lmer(gmvnohv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem2, REML=FALSE, na.action=na.exclude)
model.m4 <- lmer(gmvnohv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem2, REML=FALSE, na.action=na.exclude)
model.m4 <- lmer(gmvnohv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem2, REML=FALSE, na.action=na.exclude)
model.y4 <- lmer(memory ~ log(wmh) + gmvnohv + time + timesqrt + log(wmh):time + log(wmh):timesqrt + gmvnohv:time
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem2, REML=FALSE, na.action=na.exclude)
mediate4.out <- mediate(model.m4, model.y4, treat = "log(wmh)", mediator = "gmvnohv")
summary(mediate4.out)
summary(model.m3)
summary(model.y3)
model.m4 <- lmer(hv:time ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt + hv
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
library("lmerTest", lib.loc="C:/Program Files/R/R-3.4.2/library")
model.m3 <- lmer(hv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y3 <- lmer(memory ~ log(wmh) + hv + time + timesqrt + log(wmh):time + log(wmh):timesqrt + hv:time
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
summary(model.m3)
summary(model.y3)
summary(mediate3.out)
a
summary(mediate3.out)
model.m3 <- lmer(hv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y3 <- lmer(memory ~ log(wmh) + hv + time + timesqrt + log(wmh):time + log(wmh):timesqrt + hv:time
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate3.out <- mediate(model.m3, model.y3, treat = "log(wmh)", mediator = "hv")
model.m3 <- lmer(hv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y3 <- lmer(memory ~ log(wmh) + hv + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate3.out <- mediate(model.m3, model.y3, treat = "log(wmh)", mediator = "hv")
model.m3 <- lmer(hv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y3 <- lmer(memory ~ log(wmh) + hv + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate3.out <- mediate(model.m3, model.y3, treat = "log(wmh)", mediator = "hv")
detach("package:lmerTest", unload=TRUE)
model.m3 <- lmer(hv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y3 <- lmer(memory ~ log(wmh) + hv + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate3.out <- mediate(model.m3, model.y3, treat = "log(wmh)", mediator = "hv")
summary(mediate3.out)
model.m2 <- lmer(hv ~ log(wmh) + time + timesqrt
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y2 <- lmer(memory ~ log(wmh) + hv + time + timesqrt
+ age06c + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate2.out <- mediate(model.m2, model.y2, treat = "log(wmh)", mediator = "hv")
summary(mediate2.out)
model.m2 <- lmer(hv ~ log(wmh) + time + timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y2 <- lmer(memory ~ log(wmh) + hv + time + timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate2.out <- mediate(model.m2, model.y2, treat = "log(wmh)", mediator = "hv")
summary(mediate2.out)
model.m3 <- lmer(hv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
model.y3 <- lmer(memory ~ log(wmh) + hv + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df.incl.mem, REML=FALSE, na.action=na.exclude)
mediate3.out <- mediate(model.m3, model.y3, treat = "log(wmh)", mediator = "hv")
summary(mediate3.out)
ha <- round(predict(model.m3), digits=1)
model.ha <- lmer(hv ~ log(wmh) + time + timesqrt + log(wmh):time + log(wmh):timesqrt
+ age06mc + sex + (1+time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
ha <- round(predict(model.ha), digits=1)
model.ha <- lmer(hv ~ log(wmh) + time + age06mc + sex + (1+time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
ha <- round(predict(model.ha), digits=1)
summary(model.ha)
model.ha <- lmer(hv ~  time + age06mc + sex + log(wmh) + (1+time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(model.ha)
ha <- round(predict(model.ha), digits=1)
head(hv)
head(df$hv)
coef(model.ha)$rundmcs
slopes <- coef(model.ha)$rundmcs
head(slopes)
head(df$hv)
ha.slopes <- coef(model.ha)$rundmcs
head(ha.slopes)
mean(ha.slopes)
coef(summary(ha.slopes))[ , "Estimate"]
coef(summary(ha.slopes))
coef(summary(ha.slopes))
coef(summary(model.ha))[ , "Estimate"]
head(ha.slopes)
# Define individual hippocampal atrophy slopes (ha)
model.ha <- lmer(hv ~  time + age06mc + sex + log(wmh) + (1+time|rundmcs),
data=df, REML=FALSE, na.action=na.exclude)
summary(model.ha)
coef(summary(model.ha))[ , "Estimate"]
ha.slopes <- coef(model.ha)$rundmcs
head(ha.slopes)
ha <- ha.slopes$time
head(ha)
df.wide = read.csv("../data/RUNDMC_data_wide.csv", sep=";", dec=",")
df.wide$ha <- ha
# Memory - wmh -> hv:time = ha -> memory
variables.mem <- c("wmh06", "ha", "memory0615")
df.wide.incl.mem <- df.wide[complete.cases(df[variables.mem]),]
df.wide.incl.mem <- df.wide[complete.cases(df.wide[variables.mem]),]
model.m10 <- lmer(ha ~ log(wmh) + age06c + sex,
data=df.wide.incl.mem, REML=FALSE, na.action=na.exclude)
head(df.wide.incl.mem)
model.m10 <- lmer(ha ~ log(wmh06) + age06c + sex,
data=df.wide.incl.mem, REML=FALSE, na.action=na.exclude)
model.m10 <- lmer(ha ~ log(wmh06) + Age_2006 + Sex,
data=df.wide.incl.mem, REML=FALSE, na.action=na.exclude)
model.m10 <- lm(ha ~ log(wmh06) + Age_2006 + Sex,
data=df.wide.incl.mem, REML=FALSE, na.action=na.exclude)
model.m10 <- lm(ha ~ log(wmh06) + Age_2006 + Sex,
data=df.wide.incl.mem, na.action=na.exclude)
model.y10 <- lm(memory0615 ~ log(wmh) + ha + Age_2006 + Sex,
data=df.wide.incl.mem, na.action=na.exclude)
model.y10 <- lm(memory0615 ~ log(wmh06) + ha + Age_2006 + Sex,
data=df.wide.incl.mem, na.action=na.exclude)
summary(model.m10)
summary(model.y10)
summary(mediate10.out)
mediate10.out <- mediate(model.m10, model.y10, treat = "log(wmh06)", mediator = "ha")
summary(mediate10.out)
# Mediation analysis on cross-sectional data
# Memory - wmh -> ha -> memory
variables.mem <- c("wmh06", "ha", "memory15")
df.wide.incl.mem <- df.wide[complete.cases(df.wide[variables.mem]),]
model.m10 <- lm(ha ~ log(wmh06) + Age_2006 + Sex,
data=df.wide.incl.mem, na.action=na.exclude)
model.y10 <- lm(memory15 ~ log(wmh06) + ha + Age_2006 + Sex,
data=df.wide.incl.mem, na.action=na.exclude)
mediate10.out <- mediate(model.m10, model.y10, treat = "log(wmh06)", mediator = "ha")
summary(mediate10.out)
