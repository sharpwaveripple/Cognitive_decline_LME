library(ggplot2)
setwd("\\\\umcfs034/NEUROuser$/Z515179/Documenten_Esther/OiO/R/LGM_Cambridge")
datafile_ggplot <- "../data/ggplot_dem_wmh_hv.csv"
dem = read.csv(datafile_ggplot, sep=";", dec=",")
attach(dem)
library(ggplot2)
datafile_ggplot <- "../data/ggplot_dem_wmh_hv.csv"
dem = read.csv(datafile_ggplot, sep=";", dec=",")
datafile_ggplot <- "../data/ggplot_dem_wmh_hv.csv"
dem = read.csv(datafile_ggplot, sep=";", dec=",")
datafile_ggplot <- "../../data/ggplot_dem_wmh_hv.csv"
dem = read.csv(datafile_ggplot, sep=";", dec=",")
datafile_ggplot <- "../../data/ggplot_dem_wmh_hv.csv"
dem = read.csv(datafile_ggplot, sep=";", dec=",")
setwd("D:\Esther\Documenten\Werk\Neurologie\LGM_Cambridge\RUNDMC_LGM")
setwd("D:/Esther/Documenten/Werk/Neurologie/LGM_Cambridge/RUNDMC_LGM")
datafile_ggplot <- "../data/ggplot_dem_wmh_hv.csv"
dem = read.csv(datafile_ggplot, sep=";", dec=",")
datafile <- "../../data/ggplot_dem_wmh_hv.csv"
df <- read.csv(datafile, sep=";", dec=",")
datafile <- "../data/ggplot_dem_wmh_hv.csv"
df <- read.csv(datafile, sep=";", dec=",")
setwd("D:/Esther/Documenten/Werk/Neurologie/LGM_Cambridge/RUNDMC_LGM")
datafile <- "/data/ggplot_dem_wmh_hv.csv"
df <- read.csv(datafile, sep=";", dec=",")
datafile <- "data/ggplot_dem_wmh_hv.csv"
df <- read.csv(datafile, sep=";", dec=",")
library(ggplot2)
setwd("D:/Esther/Documenten/Werk/Neurologie/LGM_Cambridge/RUNDMC_LGM")
datafile <- "data/ggplot_dem_wmh_hv.csv"
dem <- read.csv(datafile, sep=";", dec=",")
attach(dem)
variables <- c("wmh", "hv")
df.var <- df[variables]
dem.var <- dem[variables]
dem.var.incl <- dem.var[complete.cases(dem.var), ]
datafile <- "data/ggplot_dem_wmh_hv.csv"
dem <- read.csv(datafile, sep=";", dec=",")
attach(dem)
dem <- read.csv(datafile, sep=";", dec=",")
dem.incl <- dem$inclusion==1
dem.incl <- dem[df$inclusion==1,]
dem.incl <- dem[dem$inclusion==1,]
wmh.age.plot <- ggplot(dem.incl, aes(x=age, y=wmh, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=22)
print(wmh.age.plot)
hv.age.plot <- ggplot(dem.incl, aes(x=age, y=hv, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=22)
print(hv.age.plot)
hv.age.plot <- ggplot(dem.incl, aes(x=age, y=hv, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=18)
print(hv.age.plot)
library(mice)
library(lavaan)
library(semTools)
library(psych)
datafile <- "../../data/RUNDMC_datasheet_long.csv"
library(psych)
datafile <- "../../data/RUNDMC_datasheet_long.csv"
df <- read.csv(datafile, header=T)
datafile <- "data/RUNDMC_datasheet_long.csv"
df <- read.csv(datafile, header=T)
df$ps06 <- df$pp1sat06 + df$stroop1sat06 + df$stroop2sat06 + df$ldstcorrect06
df$ps11 <- df$pp1sat11 + df$stroop1sat11 + df$stroop2sat11 + df$ldstcorrect11
df$ps15 <- df$pp1sat15 + df$stroop1sat15 + df$stroop2sat15 + df$ldstcorrect15
df$mem06 <- df$wvlt123correctmean06 + df$wvltdelayrecall06 +
df$reyimmrecalltotalscore06 +	df$reydelayrecalltotalscore06 +
df$pp2sat06 + df$pp3sat06
df$mem11 <- df$wvlt123correctmean11 + df$wvltdelayrecall11 +
df$reyimmrecalltotalscore11 +	df$reydelayrecalltotalscore11 +
df$pp2sat11 + df$pp3sat11
df$mem15 <- df$wvlt123correctmean15 + df$wvltdelayrecall15 +
df$reyimmrecalltotalscore15 +	df$reydelayrecalltotalscore15 +
df$pp2sat15 + df$pp3sat15
df$exf06 <- df$fluencyanimals06 + df$fluencyjobs06 + df$stroopinterference06 +	df$vsattotalsat06
df$exf11 <- df$fluencyanimals11 + df$fluencyjobs11 + df$stroopinterference11 +	df$vsattotalsat11
df$exf15 <- df$fluencysupermarket15 + df$fluencyjobs15 + df$stroopinterference15 +	df$vsattotalsat15
variables <- c("wmh06", "hv06", "ps06", "mem06", "exf06",
"wmh11", "hv11", "ps11", "mem11", "exf11",
"wmh15", "hv15", "ps15", "mem15", "exf15")
df.var <- df[variables]
df.var.incl <- df.var[complete.cases(df.var), ]
variables06 <- c("wmh06", "hv06", "ps06", "mem06", "exf06")
df.var.incl06 <- df.var.incl[variables06]
variables11 <- c("wmh11", "hv11", "ps11", "mem11", "exf11")
df.var.incl11 <- df.var.incl[variables11]
variables15 <- c("wmh15", "hv15", "ps15", "mem15", "exf15")
df.var.incl15 <- df.var.incl[variables15]
corr06.mat <- corr.test(df.var.incl06)
corr11.mat <- corr.test(df.var.incl11)
corr15.mat <- corr.test(df.var.incl15)
corr06.mat
corr11.mat
corr15.mat
df.cross.wmh <- as.data.frame(matrix(0, ncol=6, nrow=4))
df.cross[1:5,1] <- round(corr06.mat$r[1:5,1], digits=3)
df.cross[1:5,3] <- round(corr11.mat$r[1:5,1], digits=3)
df.cross[1:5,5] <- round(corr15.mat$r[1:5,1], digits=3)
df.cross[1:4,1] <- round(corr06.mat$r[1:4,1], digits=3)
df.cross[1:4,3] <- round(corr11.mat$r[1:4,1], digits=3)
df.cross[1:4,5] <- round(corr15.mat$r[1:4,1], digits=3)
corr06.mat <- corr.test(df.var.incl06)
corr11.mat <- corr.test(df.var.incl11)
corr15.mat <- corr.test(df.var.incl15)
corr06.mat
df.cross.wmh[1:4,1] <- round(corr06.mat$r[2:5,1], digits=3)
df.cross.wmh[1:4,3] <- round(corr11.mat$r[2:5,1], digits=3)
df.cross.wmh[1:4,5] <- round(corr15.mat$r[2:5,1], digits=3)
View(df.cross.wmh)
rownames(df.cross.wmh) <- c("hv", "psychomotor speed", "memory", "executive function")
colnames(df.cross.wmh) <- c("wmh06", "p-val", "wmh11", "p-val", "wmh15", "p-val")
df.cross.wmh[1:4,2] <- round(corr06.mat$p[2:5,1], digits=3)
corr11.mat
df.cross.wmh <- as.data.frame(matrix(0, ncol=6, nrow=4))
df.cross.wmh[1:4,1] <- round(corr06.mat$r[2:5,1], digits=3)
df.cross.wmh[1:4,3] <- round(corr11.mat$r[2:5,1], digits=3)
df.cross.wmh[1:4,5] <- round(corr15.mat$r[2:5,1], digits=3)
df.cross.wmh[1:4,2] <- round(corr06.mat$p[2:5,1], digits=3)
df.cross.wmh[1:4,4] <- round(corr11.mat$p[2:5,1], digits=3)
df.cross.wmh[1:4,6] <- round(corr15.mat$p[2:5,1], digits=3)
rownames(df.cross.wmh) <- c("hv", "psychomotor speed", "memory", "executive function")
colnames(df.cross.wmh) <- c("wmh06", "p-val", "wmh11", "p-val", "wmh15", "p-val")
corr06.mat
df.cross.hv <- as.data.frame(matrix(0, ncol=6, nrow=4))
df.cross.hv <- as.data.frame(matrix(0, ncol=6, nrow=4))
df.cross.hv[1,1] <- round(corr06.mat$r[1,2], digits=3)
df.cross.hv[2:4,1] <- round(corr06.mat$r[3:5,2], digits=3)
df.cross.hv[1,3] <- round(corr11.mat$r[1,2], digits=3)
df.cross.hv[2:4,3] <- round(corr11.mat$r[3:5,2], digits=3)
df.cross.hv[1,5] <- round(corr15.mat$r[1,2], digits=3)
df.cross.hv[2:4,5] <- round(corr15.mat$r[3:5,2], digits=3)
df.cross.hv[1,2] <- round(corr06.mat$p[1,2], digits=3)
df.cross.hv[2:4,2] <- round(corr06.mat$p[3:5,2], digits=3)
df.cross.hv[1,4] <- round(corr11.mat$p[1,2], digits=3)
df.cross.hv[2:4,4] <- round(corr11.mat$p[3:5,2], digits=3)
df.cross.hv[1,6] <- round(corr15.mat$p[1,2], digits=3)
df.cross.hv[2:4,6] <- round(corr15.mat$p[3:5,2], digits=3)
rownames(df.cross.hv) <- c("wmh", "psychomotor speed", "memory", "executive function")
colnames(df.cross.hv) <- c("hv06", "p-val", "hv11", "p-val", "hv15", "p-val")
View(df.cross.wmh)
View(df.cross.hv)
corr06.mat
df.cross.hv[1,2] <- round(corr06.mat$p[2,1], digits=3)
df.cross.hv[1,4] <- round(corr11.mat$p[2,1], digits=3)
df.cross.hv[1,6] <- round(corr15.mat$p[2,1], digits=3)
library(mice)
library(lavaan)
library(semTools)
library(psych)
impute.data <- function(data, nImps, imp.method, nIter, nseed) {
imp_data = mice(data, m = nImps, method = imp.method, seed = nseed, maxit = nIter, printFlag = T)
imp_data_means = 0
for(i in 1:nImps) {
imp_data_means = imp_data_means + complete(imp_data,i)
}
imp_data_means = imp_data_means/nImps
return(imp_data_means)
}
datafile <- "data/RUNDMC_datasheet_long.csv"
df <- read.csv(datafile, header=T)
df$ps06 <- df$pp1sat06 + df$stroop1sat06 + df$stroop2sat06 + df$ldstcorrect06
df$ps11 <- df$pp1sat11 + df$stroop1sat11 + df$stroop2sat11 + df$ldstcorrect11
df$ps15 <- df$pp1sat15 + df$stroop1sat15 + df$stroop2sat15 + df$ldstcorrect15
df$ps06 <- df$pp1sat06 + df$stroop1sat06 + df$stroop2sat06 + df$ldstcorrect06
df$ps11 <- df$pp1sat11 + df$stroop1sat11 + df$stroop2sat11 + df$ldstcorrect11
df$ps15 <- df$pp1sat15 + df$stroop1sat15 + df$stroop2sat15 + df$ldstcorrect15
df$mem06 <- df$wvlt123correctmean06 + df$wvltdelayrecall06 +
df$reyimmrecalltotalscore06 +	df$reydelayrecalltotalscore06 +
df$pp2sat06 + df$pp3sat06
df$mem11 <- df$wvlt123correctmean11 + df$wvltdelayrecall11 +
df$reyimmrecalltotalscore11 +	df$reydelayrecalltotalscore11 +
df$pp2sat11 + df$pp3sat11
df$mem15 <- df$wvlt123correctmean15 + df$wvltdelayrecall15 +
df$reyimmrecalltotalscore15 +	df$reydelayrecalltotalscore15 +
df$pp2sat15 + df$pp3sat15
df$exf06 <- df$fluencyanimals06 + df$fluencyjobs06 + df$stroopinterference06 +	df$vsattotalsat06
df$exf11 <- df$fluencyanimals11 + df$fluencyjobs11 + df$stroopinterference11 +	df$vsattotalsat11
df$exf15 <- df$fluencysupermarket15 + df$fluencyjobs15 + df$stroopinterference15 +	df$vsattotalsat15
variables.cog <- c("wmh06", "wmh11", "wmh15",
"hv06", "hv11", "hv15",
"ps06", "ps11", "ps15",
"mem06", "mem11", "mem15",
"exf06", "exf11", "exf15")
df.cog <- df[variables.cog]
df.imp <- impute.data(df.cog, 50, "pmm", 50, 1105)
variables.ps <- c("wmh06", "wmh11", "wmh15",
"hv06", "hv11", "hv15",
"ps06", "ps11", "ps15")
df.imp.ps <- df.imp[variables.ps]
variables.mem <- c("wmh06", "wmh11", "wmh15",
"hv06", "hv11", "hv15",
"mem06", "mem11", "mem15")
df.imp.mem <- df.imp[variables.mem]
variables.exf <- c("wmh06", "wmh11", "wmh15",
"hv06", "hv11", "hv15",
"exf06", "exf11", "exf15")
df.imp.exf <- df.imp[variables.exf]
wd <- getwd()
modelfile.int.ps <- paste(wd, "model_interaction.lav", sep="/")
model.int.ps <- readLines(modelfile.int.ps)
modelfile.int.ps <- paste(wd, "scripts/model_interaction.lav", sep="/")
model.int.ps <- readLines(modelfile.int.ps)
fit.int.ps <- growth(model.int.ps, data=df.imp.ps)
summary(fit.int.ps)
semPaths(fit, "stand", sizeMan = 14, label.cex = 2.3, shapeMan = "square", nCharNodes = 0, edge.label.cex = 3,
residuals=F, edge.color = "black", edge.width = 0.5)
library(semPlot)
library(ggraph)
library(ggplot2)
semPaths(fit, "stand", sizeMan = 14, label.cex = 2.3, shapeMan = "square", nCharNodes = 0, edge.label.cex = 3,
residuals=F, edge.color = "black", edge.width = 0.5)
semPaths(fit.int.ps, "stand", sizeMan = 14, label.cex = 2.3, shapeMan = "square", nCharNodes = 0, edge.label.cex = 3,
residuals=F, edge.color = "black", edge.width = 0.5)
semPaths(fit.int.ps)
semPaths(fit.int.ps, "stand", nCharNodes = 0, residuals=F)
semPaths(fit.int.ps, "stand", nCharNodes = 0,
residuals=F, edge.color = "black")
semPaths(fit.int.ps, "stand", nCharNodes = 0, edge.color = "black")
semPaths(fit.int.ps)
datafile <- "data/RUNDMC_datasheet_long.csv"
df <- read.csv(datafile, header=T)
df$hvratio06 <- df$wmh06 / df$tbv06
hvratio06
df$wmhratio06 <- df$wmh06 / df$tbv06
df$wmhratio11 <- df$wmh11 / df$tbv11
df$wmhratio15 <- df$wmh15 / df$tbv15
df$hvratio06 <- df$hv06 / df$tbv06
df$hvratio11 <- df$hv11 / df$tbv11
df$hvratio15 <- df$hv15 / df$tbv15
hist(wmhratio06)
hist(df$wmhratio06)
hist(df$wmhratio11)
hist(df$wmhratio15)
hist(df$hvratio06)
hist(df$wmhratio06)
hist(df$wmhratio11)
hist(df$wmhratio15)
hist(df$hvratio06)
hist(df$hvratio11)
hist(df$hvratio15)
df$wmhratio06p1 <- df$wmhratio06 + 1
df$wmhratio11p1 <- df$wmhratio11 + 1
df$wmhratio15p1 <- df$wmhratio15 + 1
df$hvratio06p1 <- df$hvratio06 + 1
df$hvratio11p1 <- df$hvratio11 + 1
df$hvratio15p1 <- df$hvratio15 + 1
hist(df$wmhratio06p1)
hist(df$wmhratio11p1)
hist(df$wmhratio15p1)
hist(df$hvratio06p1)
hist(df$hvratio11p1)
hist(df$hvratio15p1)
df$wmhratio06p1log <- log(df$wmhratio06p1)
df$wmhratio11p1log <- log(df$wmhratio11p1)
df$wmhratio15p1log <- log(df$wmhratio15p1)
df$wmhratio06p1log <- log(df$wmhratio06p1)
df$wmhratio11p1log <- log(df$wmhratio11p1)
df$wmhratio15p1log <- log(df$wmhratio15p1)
hist(df$wmhratio06p1log)
hist(df$wmhratio11p1log)
hist(df$wmhratio15p1log)
df$wmhratio06 <- df$wmh06 / df$tbv06
df$wmhratio11 <- df$wmh11 / df$tbv11
hist(df$wmhratio06)
df$wmhratio06p1log <- log10(df$wmhratio06p1)
hist(df$wmhratio06p1log)
df$wmhratio06p1log <- log(df$wmhratio06p1)
df$wmhratio11p1log <- log(df$wmhratio11p1)
df$wmhratio15p1log <- log(df$wmhratio15p1)
hist(df$wmhratio06p1log)
hist(df$wmhratio11p1log)
hist(df$wmhratio15p1log)
df$wmhratio06p1sqrt <- sqrt(df$wmhratio06p1)
hist(df$wmhratio06p1sqrt)
hist(df$wmhratio06p1log)
hist(df$wmhratio06)
hist(df$wmhratio06p1log)
df$wmhratio06p100log <- log(df$wmhratio06*100)
hist(df$wmhratio06p100log)
hist(df$wmhratio06)
df
df$wmhratio06p100 <- df$wmhratio06*100
hist(df$wmhratio06p100)
df$wmhratio06p100
df$wmhratio06p1000 <- df$wmhratio06*1000
df$wmhratio06p1000
df$wmhratio06
df$wmhratio06p10000 <- df$wmhratio06*10000
hist(df$wmhratio06p10000)
wmhratio06p10000
df$wmhratio06new <- df$wmhratio06*10000
hist(df$wmhratio06new)
df$wmhratio06new
df$wmhratio06new <- log(df$wmhratio06*10000)
hist(df$wmhratio06new)
df$wmh06
df$wmhratio06
df$wmhratio06new <- log(df$wmhratio06*100000)
hist(df$wmhratio06new)
df$wmhratio06new
df$wmhratio06new <- log(df$wmhratio06*1000000)
hist(df$wmhratio06new)
df$wmhratio06new
df$wmhratio06new <- log(df$wmhratio06*100000)
hist(df$wmhratio06new)
df$wmhratio06new
df$hvratio06
hist(df$hvratio06)
hist(df$hvratio11)
hist(df$hvratio15)
df$wmhratio06new <- log(df$wmhratio06*100000)
df$wmhratio06*100000
df$wmhratio06100 <- df$wmhratio06*100
wmhratio06*100
df$wmhratio06*100
df$hvratio06 <- df$hv06 / df$tbv06
df$hvratio11 <- df$hv11 / df$tbv11
df$hvratio15 <- df$hv15 / df$tbv15
hist(df$hvratio06)
hist(df$hvratio11)
hist(df$hvratio15)
datafile <- "data/RUNDMC_datasheet_long.csv"
df <- read.csv(datafile, header=T)
df$hvratio06 <- df$hv06 / df$tbv06
df$hvratio11 <- df$hv11 / df$tbv11
df$hvratio15 <- df$hv15 / df$tbv15
hist(df$hvratio06)
hist(df$hvratio11)
hist(df$hvratio15)
df$wmhprop06 <- (df$wmh06 / df$tbv06)*100
df$wmhprop11 <- (df$wmh11 / df$tbv11)*100
df$wmhprop15 <- (df$wmh15 / df$tbv15)*100
df$wmhratio06 <- log(df$wmh06 / df$tbv06)*100000
df$wmhratio11 <- log(df$wmh11 / df$tbv11)*100000
df$wmhratio15 <- log(df$wmh15 / df$tbv15)*100000
hist(df$wmhratio06)
df$wmhratio06 <- log((df$wmh06 / df$tbv06)*100000)
hist(df$wmhratio06)
hist(df$wmhratio06)
hist(df$wmhratio11)
df$wmhprop06 <- (df$wmh06 / df$tbv06)*100
df$wmhprop11 <- (df$wmh11 / df$tbv11)*100
df$wmhprop15 <- (df$wmh15 / df$tbv15)*100
df$wmhratio06 <- log((df$wmh06 / df$tbv06)*100000)
df$wmhratio11 <- log((df$wmh11 / df$tbv11)*100000)
df$wmhratio15 <- log((df$wmh15 / df$tbv15)*100000)
hist(df$wmhratio06)
hist(df$wmhratio11)
hist(df$wmhratio15)
hist(df$wmhratio06)
hist(df$wmhratio11)
hist(df$wmhratio15)
setwd("D:/Esther/Documenten/Werk/Neurologie/LGM_Cambridge/RUNDMC_LGM")
datafile <- "data/ggplot_dem_wmh_hv.csv"
dem <- read.csv(datafile, sep=";", dec=",")
dem.incl <- dem[dem$inclusion==1,]
wmhprop.age.plot <- ggplot(dem, aes(x=age, y=wmhprop, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=22)
print(wmhprop.age.plot)
wmhprop.age.plot <- ggplot(dem.incl, aes(x=age, y=wmhprop, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=22)
print(wmhprop.age.plot)
hvprop.age.plot <- ggplot(dem.incl, aes(x=age, y=hvprop, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=18)
print(hvprop.age.plot)
wmhprop.age.plot <- ggplot(dem.incl, aes(x=age, y=wmhprop, group=rundmcs)) +
geom_line() +
geom_point() +
stat_smooth(aes(group=1), method=lm, colour="#cc0000", fill="#c3c3c3", alpha=0.6) +
theme_bw(base_size=18)
print(wmhprop.age.plot)
df$hvprop06 <- (df$hv06 / df$tbv06)*100
df$hvprop11 <- (df$hv11 / df$tbv11)*100
df$hvprop15 <- (df$hv15 / df$tbv15)*100
hvprop06
datafile <- "data/RUNDMC_datasheet_long.csv"
df <- read.csv(datafile, header=T)
df$hvratio06 <- df$hv06 / df$tbv06
df$hvratio11 <- df$hv11 / df$tbv11
df$hvratio15 <- df$hv15 / df$tbv15
df$hvprop06 <- (df$hv06 / df$tbv06)*100
df$hvprop11 <- (df$hv11 / df$tbv11)*100
df$hvprop15 <- (df$hv15 / df$tbv15)*100
hvprop06
df$hvprop06
